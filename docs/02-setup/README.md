# Тема 2: Встановлення та початкова конфігурація

## Цілі навчання

Після вивчення цієї теми ви зможете:

- Навчитися встановлювати Cypress
- Зрозуміти процес ініціалізації проекту
- Ознайомитися з базовою структурою проекту
- Створити свій перший тест

## Передумови та системні вимоги

### Необхідне програмне забезпечення

1. **Node.js**
   - Мінімальна версія: 16.x або вище
   - Перевірка версії: `node --version`

2. **npm (Node Package Manager)**
   - Зазвичай встановлюється разом з Node.js
   - Мінімальна версія: 8.x або вище
   - Перевірка версії: `npm --version`

### Системні вимоги

Cypress підтримує наступні операційні системи:
- macOS 10.9 і вище
- Linux (Ubuntu, Debian, Fedora)
- Windows 7 і вище

## Встановлення Cypress

### Крок 1: Ініціалізація npm проекту

Якщо у вас ще немає `package.json`, створіть його:

```bash
npm init -y
```

Ця команда створить базовий `package.json` файл з дефолтними значеннями.

### Крок 2: Встановлення Cypress

Встановіть Cypress як dev-залежність:

```bash
npm install cypress --save-dev
```

**Чому `--save-dev`?**
- Cypress використовується тільки для розробки та тестування
- Не потрібен у продакшені
- Зберігається в `devDependencies` в `package.json`

### Крок 3: Перевірка встановлення

Після встановлення перевірте, що все працює:

```bash
npx cypress verify
```

Якщо все встановлено правильно, ви побачите повідомлення про успішну перевірку.

## Ініціалізація Cypress проекту

### Крок 1: Запуск Cypress UI

Запустіть Cypress в інтерактивному режимі:

```bash
npx cypress open
```

Або додайте скрипт у `package.json`:

```json
{
  "scripts": {
    "cypress:open": "cypress open"
  }
}
```

Тоді можна запускати просто: `npm run cypress:open`

### Крок 2: Вибір типу тестування

При першому запуску Cypress запропонує вибрати тип тестування:

- **E2E Testing** - для End-to-End тестів (рекомендовано для початку)
- **Component Testing** - для компонентних тестів

Для нашого курсу оберіть **E2E Testing**.

### Крок 3: Огляд згенерованих файлів

Після вибору E2E Testing, Cypress створить базову структуру:

```
cypress/
├── e2e/              # Тут будуть ваші тестові файли
├── fixtures/         # Тестові дані (JSON файли)
└── support/          # Підтримуючі файли
    ├── commands.js   # Кастомні команди
    └── e2e.js        # Глобальні налаштування
```

Також буде створено файл `cypress.config.js` в корені проекту.

### Крок 4: Налаштування spec pattern

Cypress автоматично налаштує патерн для пошуку тестових файлів. За замовчуванням він шукає файли з розширенням `.cy.{js,jsx,ts,tsx}` в папці `cypress/e2e/`.

## Базова конфігурація

### Файл cypress.config.js

Після ініціалізації створюється файл `cypress.config.js` з базовою конфігурацією:

```javascript
const { defineConfig } = require('cypress')

module.exports = defineConfig({
  e2e: {
    setupNodeEvents(on, config) {
      // налаштування плагінів
    },
  },
})
```

### Налаштування baseUrl

Для зручності можна встановити базовий URL для всіх тестів:

```javascript
module.exports = defineConfig({
  baseUrl: 'https://todomvc.com/examples/react/dist/',
  e2e: {
    // ...
  },
})
```

Після цього можна використовувати відносні шляхи:
- Замість `cy.visit('https://todomvc.com/examples/react/dist/')`
- Можна писати `cy.visit('/')`

## Створення першого тесту

### Крок 1: Створення тестового файлу

Створіть файл `cypress/e2e/first-test.cy.js`:

```javascript
describe('Мій перший тест', () => {
  it('має відкрити TodoMVC', () => {
    // Відкриваємо сторінку
    cy.visit('/')
    
    // Перевіряємо, що заголовок відображається
    cy.get('h1').should('contain', 'todos')
  })
})
```

### Крок 2: Запуск тесту

1. Відкрийте Cypress UI: `npm run cypress:open`
2. Оберіть браузер (Chrome, Firefox, Edge або Electron)
3. Клікніть на тест `first-test.cy.js`
4. Спостерігайте за виконанням тесту

## Структура проекту

Після повної ініціалізації ваша структура проекту має виглядати так:

```
my-project/
├── cypress/
│   ├── e2e/              # Тестові файли
│   ├── fixtures/         # Тестові дані
│   └── support/          # Підтримуючі файли
├── cypress.config.js     # Конфігурація Cypress
├── package.json          # Залежності проекту
└── node_modules/         # Встановлені пакети
```

## Практичні приклади

У папці `examples/` знаходяться робочі приклади:
- `package.json` - приклад конфігурації проекту
- `cypress.config.js` - базова конфігурація з baseUrl для TodoMVC
- `first-test.cy.js` - перший тест на TodoMVC

## Типові помилки

1. **Встановлення Cypress глобально замість локального**
   - ❌ Неправильно: `npm install -g cypress`
   - ✅ Правильно: `npm install cypress --save-dev`
   - Чому? Версія Cypress має бути зафіксована в проекті

2. **Неправильна структура папок після ініціалізації**
   - Переконайтеся, що ви обрали E2E Testing
   - Перевірте, що файл `cypress.config.js` створено в корені проекту

3. **Проблеми з правами доступу на Windows**
   - Запускайте термінал від імені адміністратора
   - Перевірте права доступу до папки проекту

## Наступні кроки

Після вивчення цієї теми перейдіть до:
- [Тема 3: Cypress UI та Test Runner](../03-ui/README.md)
